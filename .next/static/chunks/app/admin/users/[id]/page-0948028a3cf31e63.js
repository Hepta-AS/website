(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[214],{1595:function(e,s,r){Promise.resolve().then(r.bind(r,3988))},3988:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return j}});var a=r(7437),l=r(2265),t=r(9376),n=r(2869),i=r(6070),c=r(3022),d=r(8730),x=r(2660),h=r(7168);function o(e){let{userId:s}=e,{sessionToken:r}=(0,d.a)(),[t,x]=(0,l.useState)(null),[o,j]=(0,l.useState)(!0),[m,u]=(0,l.useState)(null),f=async()=>{try{j(!0),u(null);let e=await fetch("/api/admin/stripe-customer?userId=".concat(s),{headers:{Authorization:"Bearer ".concat(r||"test_session")}});if(!e.ok)throw Error("Failed to fetch customer info: ".concat(await e.text()));let a=await e.json();x(a.customer||null)}catch(e){console.error("Error fetching customer info:",e),u(e instanceof Error?e.message:"Failed to fetch customer info")}finally{j(!1)}};return((0,l.useEffect)(()=>{s&&f()},[s,r]),o)?(0,a.jsxs)(i.Zb,{className:"border-gray-800 bg-gray-900/50",children:[(0,a.jsx)(i.Ol,{className:"pb-2",children:(0,a.jsx)(c.O,{className:"h-6 w-1/3"})}),(0,a.jsxs)(i.aY,{children:[(0,a.jsx)(c.O,{className:"h-4 w-full mb-2"}),(0,a.jsx)(c.O,{className:"h-4 w-3/4"})]})]}):m?(0,a.jsxs)(i.Zb,{className:"border-red-800 bg-red-900/20",children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{children:"Feil ved lasting av kundeinformasjon"})}),(0,a.jsxs)(i.aY,{children:[(0,a.jsx)("p",{className:"text-red-400",children:m}),(0,a.jsx)(n.z,{onClick:f,variant:"outline",className:"mt-4",children:"Pr\xf8v igjen"})]})]}):t?(0,a.jsxs)(i.Zb,{className:"border-gray-800 bg-gray-900/50",children:[(0,a.jsxs)(i.Ol,{className:"pb-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(i.ll,{children:"Stripe kundeinformasjon"}),(0,a.jsxs)(n.z,{onClick:f,variant:"outline",size:"sm",className:"gap-2",children:[(0,a.jsx)(h.Z,{className:"h-4 w-4"}),"Oppdater"]})]}),(0,a.jsxs)(i.SZ,{children:["Kunde ID: ",t.id]})]}),(0,a.jsx)(i.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"E-post"}),(0,a.jsx)("div",{children:t.email})]}),t.name&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"Navn"}),(0,a.jsx)("div",{children:t.name})]}),t.phone&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"Telefon"}),(0,a.jsx)("div",{children:t.phone})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"Opprettet"}),(0,a.jsx)("div",{children:new Date(1e3*t.created).toLocaleDateString()})]}),t.metadata&&Object.keys(t.metadata).length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"Metadata"}),(0,a.jsx)("div",{className:"bg-gray-800 p-2 rounded text-xs",children:(0,a.jsx)("pre",{children:JSON.stringify(t.metadata,null,2)})})]})]})})]}):(0,a.jsx)(i.Zb,{className:"border-gray-800 bg-gray-900/50",children:(0,a.jsxs)(i.Ol,{children:[(0,a.jsx)(i.ll,{children:"Ingen kundeinformasjon"}),(0,a.jsx)(i.SZ,{children:"Denne brukeren har ingen Stripe kunde tilknyttet."})]})})}function j(){let e=(0,t.useParams)(),s=(0,t.useRouter)(),{sessionToken:r}=(0,d.a)(),[h,j]=(0,l.useState)(null),[m,u]=(0,l.useState)(!0),[f,g]=(0,l.useState)(null),N=null==e?void 0:e.id,v=async()=>{try{u(!0),g(null);let e=await fetch("/api/admin/users/".concat(N),{headers:{Authorization:"Bearer ".concat(r||"test_session")}});if(!e.ok)throw Error("Failed to fetch user: ".concat(await e.text()));let s=await e.json();j(s.user||null)}catch(e){console.error("Error fetching user:",e),g(e instanceof Error?e.message:"Failed to fetch user")}finally{u(!1)}};return(0,l.useEffect)(()=>{N&&v()},[N,r]),(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(n.z,{variant:"outline",size:"icon",onClick:()=>s.back(),children:(0,a.jsx)(x.Z,{className:"h-4 w-4"})}),(0,a.jsx)("h1",{className:"text-4xl font-bold",children:"Brukerdetaljer"})]}),m?(0,a.jsxs)(i.Zb,{className:"border-gray-800 bg-gray-900/50",children:[(0,a.jsx)(i.Ol,{className:"pb-2",children:(0,a.jsx)(c.O,{className:"h-6 w-1/3"})}),(0,a.jsxs)(i.aY,{children:[(0,a.jsx)(c.O,{className:"h-4 w-full mb-2"}),(0,a.jsx)(c.O,{className:"h-4 w-3/4"})]})]}):f?(0,a.jsxs)(i.Zb,{className:"border-red-800 bg-red-900/20",children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{children:"Feil ved lasting av bruker"})}),(0,a.jsxs)(i.aY,{children:[(0,a.jsx)("p",{className:"text-red-400",children:f}),(0,a.jsx)(n.z,{onClick:v,variant:"outline",className:"mt-4",children:"Pr\xf8v igjen"})]})]}):h?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i.Zb,{className:"border-gray-800 bg-gray-900/50",children:[(0,a.jsxs)(i.Ol,{children:[(0,a.jsx)(i.ll,{children:h.full_name||h.email}),(0,a.jsx)(i.SZ,{children:h.email})]}),(0,a.jsx)(i.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"Bruker ID"}),(0,a.jsx)("div",{className:"font-mono text-sm",children:h.id})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"Opprettet"}),(0,a.jsx)("div",{children:new Date(h.created_at).toLocaleDateString()})]}),h.stripe_customer_id&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"Stripe kunde ID"}),(0,a.jsx)("div",{className:"font-mono text-sm",children:h.stripe_customer_id})]})]})})]}),(0,a.jsx)(o,{userId:h.id})]}):(0,a.jsxs)(i.Zb,{className:"border-gray-800 bg-gray-900/50",children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{children:"Bruker ikke funnet"})}),(0,a.jsxs)(i.aY,{children:[(0,a.jsx)("p",{children:"Kunne ikke finne brukeren du leter etter."}),(0,a.jsx)(n.z,{onClick:()=>s.push("/admin/users"),variant:"outline",className:"mt-4",children:"Tilbake til brukerliste"})]})]})]})}},2660:function(e,s,r){"use strict";r.d(s,{Z:function(){return a}});let a=(0,r(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])}},function(e){e.O(0,[569,523,273,971,117,744],function(){return e(e.s=1595)}),_N_E=e.O()}]);