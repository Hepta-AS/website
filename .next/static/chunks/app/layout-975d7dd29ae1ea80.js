(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{6053:function(e,t,s){Promise.resolve().then(s.t.bind(s,7960,23)),Promise.resolve().then(s.bind(s,8890)),Promise.resolve().then(s.bind(s,8546)),Promise.resolve().then(s.bind(s,2798)),Promise.resolve().then(s.bind(s,8730)),Promise.resolve().then(s.t.bind(s,2972,23)),Promise.resolve().then(s.t.bind(s,4742,23))},5546:function(e,t,s){"use strict";s.d(t,{_:function(){return u}});var n=s(7437),o=s(2265),r=s(5452),a=s(2869),i=s(6110),l=s(5186),c=s(5863);function u(e){let{isOpen:t,onClose:s}=e,[u,d]=(0,o.useState)(""),[m,f]=(0,o.useState)(""),[h,g]=(0,o.useState)(!1),[p,x]=(0,o.useState)(null),b=(0,r.createClientComponentClient)(),v=async()=>{g(!0),x(null);try{let{error:e}=await b.auth.signInWithPassword({email:u,password:m});e?(console.error("Login error:",e.message),x("Feil e-post eller passord.")):(s(),window.location.href="/dashboard")}catch(e){console.error("Unexpected error:",e),x("Noe gikk galt. Pr\xf8v igjen.")}finally{g(!1)}};return(0,n.jsx)(i.Vq,{open:t,onOpenChange:s,children:(0,n.jsxs)(i.cZ,{className:"sm:max-w-[425px]",children:[(0,n.jsxs)(i.fK,{children:[(0,n.jsx)(i.$N,{children:"Logg inn"}),(0,n.jsx)(i.Be,{children:"Logg inn med e-post og passord"})]}),(0,n.jsxs)("div",{className:"space-y-4 pt-4",children:[(0,n.jsx)(l.I,{type:"email",placeholder:"E-post",value:u,onChange:e=>d(e.target.value),required:!0}),(0,n.jsx)(l.I,{type:"password",placeholder:"Passord",value:m,onChange:e=>f(e.target.value),required:!0}),p&&(0,n.jsx)("p",{className:"text-sm text-red-500",children:p}),(0,n.jsx)(a.z,{className:"w-full",onClick:v,disabled:h||!u||!m,children:h?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Logger inn..."]}):"Logg inn"})]})]})})}},8890:function(e,t,s){"use strict";s.d(t,{MainNav:function(){return f}});var n=s(7437),o=s(2265),r=s(9376),a=s(7648),i=s(3145),l=s(2869),c=s(8730),u=s(5546),d=s(2489),m=s(3566);function f(){let{logout:e,checkAuth:t}=(0,c.a)(),[s,f]=(0,o.useState)(!1),[h,g]=(0,o.useState)(!1),[p,x]=(0,o.useState)(!1),b=(0,r.useRouter)(),v=(0,r.usePathname)();(0,o.useEffect)(()=>{(async()=>{let{isLoggedIn:e}=await t();x(e)})()},[t]);let j=async()=>{await e(),g(!1),"/"!==v&&b.push("/")},S=e=>{let t="font-medium text-sm hover:text-blue-400 transition-colors";return v===e?"text-blue-500 ".concat(t):"text-neutral-300 ".concat(t)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"fixed top-0 left-0 w-full z-50 bg-neutral-950 border-b px-4 md:px-6 py-2 shadow-sm flex items-center justify-between",children:[(0,n.jsx)("div",{className:"flex items-center px-3 py-2 md:px-4 rounded-r-lg h-full shadow-md",children:(0,n.jsx)("button",{onClick:()=>{f(!1),g(!1),window.location.href="/"},className:"flex items-center mr-3 group","aria-label":"Hepta Hjem",children:(0,n.jsx)("div",{className:"relative h-5 w-auto aspect-[4/1]",children:(0,n.jsx)(i.default,{src:"/A_white_hepta.png",alt:"Hepta Logo",fill:!0,className:"object-contain",priority:!0})})})}),(0,n.jsx)("nav",{className:"hidden md:flex items-center gap-4 ml-4",children:p?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.default,{href:"/",className:S("/"),children:"Hjem"}),(0,n.jsx)(a.default,{href:"/dashboard",className:S("/dashboard"),children:"Dashboard"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.default,{href:"/",className:S("/"),children:"Hjem"}),(0,n.jsx)(a.default,{href:"/tjenester",className:S("/tjenester"),children:"Tjenester"}),(0,n.jsx)(a.default,{href:"/om-oss",className:S("/om-oss"),children:"Om oss"})]})}),(0,n.jsxs)("div",{className:"hidden md:flex items-center space-x-3 ml-auto",children:[(0,n.jsx)(l.z,{className:"bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-1.5 rounded-full text-sm",onClick:()=>{b.push("/contact"),g(!1)},children:"Kontakt"}),(0,n.jsx)(l.z,{className:"".concat(p?"bg-neutral-100 hover:bg-neutral-200 text-neutral-900":"bg-white hover:bg-gray-100 text-blue-700"," font-medium px-4 py-1.5 rounded-full text-sm"),onClick:p?j:()=>{f(!0),g(!1)},children:p?"Logg ut":"Logg inn"})]}),(0,n.jsx)("div",{className:"md:hidden ml-auto",children:(0,n.jsx)(l.z,{variant:"ghost",size:"icon",onClick:()=>g(!h),className:"text-white",children:h?(0,n.jsx)(d.Z,{size:20}):(0,n.jsx)(m.Z,{size:20})})})]}),h&&(0,n.jsxs)("div",{className:"fixed top-14 left-0 w-full bg-neutral-950 border-t border-neutral-800 px-6 py-4 z-40 md:hidden shadow-lg animate-fade-in space-y-4",children:[(0,n.jsx)("div",{className:"flex flex-col gap-3",children:p?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.default,{href:"/",className:S("/"),onClick:()=>g(!1),children:"Hjem"}),(0,n.jsx)(a.default,{href:"/dashboard",className:S("/dashboard"),onClick:()=>g(!1),children:"Dashboard"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.default,{href:"/",className:S("/"),onClick:()=>g(!1),children:"Hjem"}),(0,n.jsx)(a.default,{href:"/tjenester",className:S("/tjenester"),onClick:()=>g(!1),children:"Tjenester"}),(0,n.jsx)(a.default,{href:"/om-oss",className:S("/om-oss"),onClick:()=>g(!1),children:"Om oss"})]})}),(0,n.jsx)("div",{className:"flex flex-col gap-3 pt-2",children:(0,n.jsx)("button",{onClick:()=>{window.location.href="/"},className:"flex items-center mr-3 group","aria-label":"Hepta Hjem",children:(0,n.jsx)("div",{className:"relative h-5 w-auto aspect-[4/1]",children:(0,n.jsx)(i.default,{src:"/A_white_hepta.png",alt:"Hepta Logo",layout:"fill",objectFit:"contain",priority:!0})})})})]}),(0,n.jsx)(u._,{isOpen:s,onClose:()=>f(!1)})]})}},8546:function(e,t,s){"use strict";s.d(t,{ProgressBar:function(){return d}});var n=s(7437),o=s(29),r=s.n(o),a=s(2265),i=s(9376),l=s(1318),c=s.n(l);function u(){let e=(0,i.usePathname)(),t=(0,i.useSearchParams)();return(0,a.useEffect)(()=>{c().start();let e=setTimeout(()=>{c().done()},500);return()=>{clearTimeout(e),c().done()}},[e,t]),(0,n.jsx)(r(),{id:"1014816bc12ceb68",children:"#nprogress{pointer-events:none}#nprogress .bar{background:#06F;position:fixed;z-index:9999;top:0;left:0;width:100%;height:3px}#nprogress .peg{display:block;position:absolute;right:0px;width:100px;height:100%;-webkit-box-shadow:0 0 10px#06F,0 0 5px#06F;-moz-box-shadow:0 0 10px#06F,0 0 5px#06F;box-shadow:0 0 10px#06F,0 0 5px#06F;opacity:1;-webkit-transform:rotate(3deg)translate(0px,-4px);-moz-transform:rotate(3deg)translate(0px,-4px);-ms-transform:rotate(3deg)translate(0px,-4px);-o-transform:rotate(3deg)translate(0px,-4px);transform:rotate(3deg)translate(0px,-4px)}"})}function d(){return(0,n.jsx)(a.Suspense,{fallback:null,children:(0,n.jsx)(u,{})})}s(8652),c().configure({minimum:.3,easing:"ease",speed:800,showSpinner:!1})},2798:function(e,t,s){"use strict";s.d(t,{ThemeProvider:function(){return r}});var n=s(7437);s(2265);var o=s(8298);function r(e){let{children:t,...s}=e;return(0,n.jsx)(o.f,{...s,children:t})}},2869:function(e,t,s){"use strict";s.d(t,{z:function(){return c}});var n=s(7437),o=s(2265),r=s(7053),a=s(535),i=s(4508);let l=(0,a.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-blue-600 text-white hover:bg-blue-700",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=o.forwardRef((e,t)=>{let{className:s,variant:o,size:a,asChild:c=!1,...u}=e,d=c?r.g7:"button";return(0,n.jsx)(d,{className:(0,i.cn)(l({variant:o,size:a,className:s})),ref:t,...u})});c.displayName="Button"},6110:function(e,t,s){"use strict";s.d(t,{$N:function(){return f},Be:function(){return h},Vq:function(){return l},cZ:function(){return d},fK:function(){return m}});var n=s(7437),o=s(2265),r=s(9027),a=s(2489),i=s(4508);let l=r.fC;r.xz;let c=r.h_;r.x8;let u=o.forwardRef((e,t)=>{let{className:s,...o}=e;return(0,n.jsx)(r.aV,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...o})});u.displayName=r.aV.displayName;let d=o.forwardRef((e,t)=>{let{className:s,children:o,...l}=e;return(0,n.jsxs)(c,{children:[(0,n.jsx)(u,{}),(0,n.jsxs)(r.VY,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...l,children:[o,(0,n.jsxs)(r.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,n.jsx)(a.Z,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});d.displayName=r.VY.displayName;let m=e=>{let{className:t,...s}=e;return(0,n.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};m.displayName="DialogHeader";let f=o.forwardRef((e,t)=>{let{className:s,...o}=e;return(0,n.jsx)(r.Dx,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",s),...o})});f.displayName=r.Dx.displayName;let h=o.forwardRef((e,t)=>{let{className:s,...o}=e;return(0,n.jsx)(r.dk,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",s),...o})});h.displayName=r.dk.displayName},5186:function(e,t,s){"use strict";s.d(t,{I:function(){return a}});var n=s(7437),o=s(2265),r=s(4508);let a=o.forwardRef((e,t)=>{let{className:s,type:o,...a}=e;return(0,n.jsx)("input",{type:o,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...a})});a.displayName="Input"},8730:function(e,t,s){"use strict";s.d(t,{AuthProvider:function(){return m},a:function(){return f}});var n=s(7437),o=s(2265),r=s(5452),a=s(9376),i=s(4508);let l=(0,o.createContext)({user:null,sessionToken:null,userRole:null,login:async()=>{},logout:async()=>{},checkAuth:async()=>({isLoggedIn:!1,user:null}),createTestSession:async()=>{}}),c={id:"test-user-id",email:"test@example.com",user_metadata:{full_name:"Test User"},app_metadata:{},aud:"authenticated",created_at:new Date().toISOString(),role:"admin"},u=()=>"test_"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),d=e=>{var t;if("undefined"==typeof document)return null;let s="; ".concat(document.cookie).split("; ".concat(e,"="));return 2===s.length&&(null===(t=s.pop())||void 0===t?void 0:t.split(";").shift())||null},m=e=>{let{children:t,serverSession:s=null}=e,[m,f]=(0,o.useState)(null),[h,g]=(0,o.useState)(null),[p,x]=(0,o.useState)(null),[b]=(0,o.useState)(()=>(0,r.createClientComponentClient)()),v=(0,a.useRouter)(),j=(0,o.useRef)(!1),S=(0,o.useCallback)(async e=>{if(!e||!e.email)return null;try{var t;let s=await fetch("/api/stripe/create-customer-for-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e.id,email:e.email,name:(null===(t=e.user_metadata)||void 0===t?void 0:t.full_name)||e.email.split("@")[0]})});if(!s.ok){let e=await s.text();return console.error("Failed to create Stripe customer:",e),null}let{customerId:n}=await s.json();return n}catch(e){return console.error("Error ensuring Stripe customer:",e),null}},[]),y=(0,o.useCallback)(async()=>{console.log("Checking auth state..."),"authenticated"===d("session")&&console.log("Found authenticated session cookie");let e=(0,i.$o)("testSession");if(e)try{return console.log("Found test session:",e),f(e.user),g(e.token),x(e.user.role||"customer"),document.cookie="hasTestSession=true; path=/",{isLoggedIn:!0,user:e.user}}catch(e){console.error("Error parsing test session:",e),(0,i.dZ)("testSession")}let{data:{session:t}}=await b.auth.getSession();if(console.log("Auth session:",t?"Exists":"None"),t){console.log("Setting logged in state to true"),f(t.user),g(t.access_token),document.cookie="session=authenticated; path=/; max-age=".concat(604800,"; SameSite=Strict; Secure");try{let{data:e,error:s}=await b.from("profiles").select("role").eq("id",t.user.id).single();!s&&e?x(e.role||"customer"):x("customer")}catch(e){console.error("Error fetching user role:",e),x("customer")}S(t.user)}else console.log("Setting logged in state to false"),f(null),g(null),x(null),document.cookie="session=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT; SameSite=Strict; Secure";return{isLoggedIn:!!t,user:(null==t?void 0:t.user)||null}},[b.auth,S]);(0,o.useEffect)(()=>{j.current||(y(),j.current=!0)},[y]),(0,o.useEffect)(()=>{let{data:{subscription:e}}=b.auth.onAuthStateChange(async(e,t)=>{console.log("Auth state changed:",{event:e,session:t}),t?(console.log("Auth state change: User logged in"),f(t.user),g(t.access_token),(0,i.qQ)("sessionToken",t.access_token),document.cookie="session=authenticated; path=/; max-age=".concat(604800,"; SameSite=Strict; Secure")):(0,i.$o)("testSession")||(console.log("Auth state change: User logged out"),f(null),g(null),(0,i.dZ)("sessionToken"),document.cookie="session=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT; SameSite=Strict; Secure")});return()=>{e.unsubscribe()}},[b.auth]);let w=async()=>{console.log("Creating test session");let e=u(),t={user:{...c,role:"admin"},token:e,created_at:new Date().toISOString()};(0,i.qQ)("testSession",t),(0,i.qQ)("sessionToken",e),document.cookie="hasTestSession=true; path=/; SameSite=Strict; Secure",document.cookie="session=authenticated; path=/; max-age=".concat(604800,"; SameSite=Strict; Secure"),f(c),g(e),x("admin"),console.log("Test session created:",t)},k=async(e,t)=>{console.log("Attempting login with email:",e);try{await new Promise(e=>setTimeout(e,500));let{data:s,error:n}=await b.auth.signInWithPassword({email:e,password:t});if(n)throw console.error("Login error:",n),n;console.log("Login successful:",s.session?"Session exists":"No session"),s.session&&(f(s.session.user),g(s.session.access_token),(0,i.qQ)("sessionToken",s.session.access_token),document.cookie="session=authenticated; path=/; max-age=".concat(604800,"; SameSite=Strict; Secure"),console.log("Auth state updated after login"))}catch(e){throw console.error("Login process error:",e),e}},N=async()=>{(0,i.dZ)("testSession"),(0,i.dZ)("sessionToken"),document.cookie="hasTestSession=false; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT; SameSite=Strict; Secure",document.cookie="session=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT; SameSite=Strict; Secure",await b.auth.signOut(),f(null),g(null),x(null),v.push("/")};return(0,n.jsx)(l.Provider,{value:{user:m,sessionToken:h,userRole:p,login:k,logout:N,checkAuth:y,createTestSession:w},children:t})},f=()=>{let e=(0,o.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},4508:function(e,t,s){"use strict";s.d(t,{$o:function(){return a},cn:function(){return r},dZ:function(){return l},qQ:function(){return i}});var n=s(1994),o=s(3335);function r(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,o.m6)((0,n.W)(t))}function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{let s=localStorage.getItem(e);if(null===s)return t;return JSON.parse(s)}catch(s){return console.error('Error reading localStorage key "'.concat(e,'":'),s),t}}function i(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch(t){console.error('Error setting localStorage key "'.concat(e,'":'),t)}}function l(e){try{localStorage.removeItem(e)}catch(t){console.error('Error removing localStorage key "'.concat(e,'":'),t)}}},7960:function(){}},function(e){e.O(0,[587,866,569,523,451,145,579,29,316,971,117,744],function(){return e(e.s=6053)}),_N_E=e.O()}]);