(()=>{var e={};e.id=9674,e.ids=[9674],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},55773:(e,r,s)=>{"use strict";s.r(r),s.d(r,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>o,routeModule:()=>p,tree:()=>c});var t=s(50482),a=s(69108),i=s(62563),n=s.n(i),l=s(68300),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);s.d(r,d);let c=["",{children:["admin",{children:["users",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,51985)),"/Users/alexanderamundsen/hepta/hepta-3/app/admin/users/page.tsx"]}]},{loading:[()=>Promise.resolve().then(s.bind(s,44596)),"/Users/alexanderamundsen/hepta/hepta-3/app/admin/users/loading.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,80261)),"/Users/alexanderamundsen/hepta/hepta-3/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,69361,23)),"next/dist/client/components/not-found-error"]}],o=["/Users/alexanderamundsen/hepta/hepta-3/app/admin/users/page.tsx"],u="/admin/users/page",m={require:s,loadChunk:()=>Promise.resolve()},p=new t.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/users/page",pathname:"/admin/users",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},59352:(e,r,s)=>{Promise.resolve().then(s.bind(s,12923))},35303:()=>{},12923:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>j});var t=s(95344),a=s(3729),i=s(16212),n=s(61351),l=s(92549),d=s(54572),c=s(67951),o=s(9046),u=s(33733),m=s(28765),p=s(42739),x=s(69224);let h=(0,x.Z)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),f=(0,x.Z)("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);var g=s(69436),y=s(22254);function j(){let{sessionToken:e,userRole:r}=(0,o.useAuth)(),s=(0,y.useRouter)(),[x,j]=(0,a.useState)([]),[b,v]=(0,a.useState)(!0),[N,k]=(0,a.useState)(null),[w,_]=(0,a.useState)(""),[S,q]=(0,a.useState)(null),[C,P]=(0,a.useState)(""),[Z,O]=(0,a.useState)(null),E="admin"===r;if((0,a.useEffect)(()=>{E||s.push("/dashboard")},[E,s]),!E)return(0,t.jsxs)("div",{className:"space-y-8",children:[t.jsx("h1",{className:"text-4xl font-bold",children:"Administrer brukere"}),(0,t.jsxs)(n.Zb,{className:"border-red-800 bg-red-900/20",children:[t.jsx(n.Ol,{children:t.jsx(n.ll,{children:"Ingen tilgang"})}),(0,t.jsxs)(n.aY,{children:[t.jsx("p",{className:"text-red-400",children:"Du har ikke tilgang til denne siden. Kun administratorer kan se denne siden."}),t.jsx(i.z,{onClick:()=>s.push("/dashboard"),variant:"outline",className:"mt-4",children:"Tilbake til dashboard"})]})]})]});let I=async()=>{try{v(!0),k(null);let r=await fetch("/api/admin/users",{headers:{Authorization:`Bearer ${e||"test_session"}`}});if(!r.ok)throw Error(`Failed to fetch users: ${await r.text()}`);let s=await r.json();j(s.users||[])}catch(e){console.error("Error fetching users:",e),k(e instanceof Error?e.message:"Failed to fetch users")}finally{v(!1)}};(0,a.useEffect)(()=>{I()},[e]);let M=async(r,s,t)=>{try{q(r);let a=await fetch("/api/admin/create-stripe-customer",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e||"test_session"}`},body:JSON.stringify({userId:r,email:s,name:t})});if(!a.ok)throw Error(`Failed to create Stripe customer: ${await a.text()}`);let i=await a.json();return j(x.map(e=>e.id===r?{...e,stripe_customer_id:i.customerId}:e)),i.customerId}catch(e){return console.error("Error creating Stripe customer:",e),alert(e instanceof Error?e.message:"Failed to create Stripe customer"),null}finally{q(null)}},F=async r=>{if(!C){alert("Please enter a Stripe customer ID");return}try{O(r);let s=await fetch("/api/admin/assign-stripe-customer",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e||"test_session"}`},body:JSON.stringify({userId:r,customerId:C})});if(!s.ok)throw Error(`Failed to assign Stripe customer: ${await s.text()}`);j(x.map(e=>e.id===r?{...e,stripe_customer_id:C}:e)),P("")}catch(e){console.error("Error assigning Stripe customer:",e),alert(e instanceof Error?e.message:"Failed to assign Stripe customer")}finally{O(null)}},A=x.filter(e=>e.email?.toLowerCase().includes(w.toLowerCase())||e.full_name?.toLowerCase().includes(w.toLowerCase())||e.stripe_customer_id?.includes(w));return(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-4xl font-bold",children:"Administrer brukere"}),(0,t.jsxs)(i.z,{onClick:I,variant:"outline",className:"gap-2",children:[t.jsx(u.Z,{className:"h-4 w-4"}),"Oppdater"]})]}),(0,t.jsxs)("div",{className:"relative",children:[t.jsx(m.Z,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-500"}),t.jsx(l.I,{placeholder:"S\xf8k etter brukere...",className:"pl-10",value:w,onChange:e=>_(e.target.value)})]}),b?t.jsx("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,t.jsxs)(n.Zb,{className:"border-gray-800 bg-gray-900/50",children:[t.jsx(n.Ol,{className:"pb-2",children:t.jsx(c.O,{className:"h-6 w-1/3"})}),t.jsx(n.aY,{children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[t.jsx(c.O,{className:"h-5 w-1/4"}),t.jsx(c.O,{className:"h-9 w-24"})]})})]},e))}):N?(0,t.jsxs)(n.Zb,{className:"border-red-800 bg-red-900/20",children:[t.jsx(n.Ol,{children:t.jsx(n.ll,{children:"Feil ved lasting av brukere"})}),(0,t.jsxs)(n.aY,{children:[t.jsx("p",{className:"text-red-400",children:N}),t.jsx(i.z,{onClick:I,variant:"outline",className:"mt-4",children:"Pr\xf8v igjen"})]})]}):0===A.length?t.jsx(n.Zb,{className:"border-gray-800 bg-gray-900/50",children:(0,t.jsxs)(n.Ol,{children:[t.jsx(n.ll,{children:"Ingen brukere funnet"}),t.jsx(n.SZ,{children:w?"Ingen brukere matcher s\xf8ket ditt.":"Det er ingen brukere i systemet enn\xe5."})]})}):t.jsx("div",{className:"space-y-4",children:A.map(e=>(0,t.jsxs)(n.Zb,{className:"border-gray-800 bg-gray-900/50",children:[(0,t.jsxs)(n.Ol,{className:"pb-2",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[t.jsx(n.ll,{children:e.full_name||e.email}),e.stripe_customer_id?t.jsx(g.C,{className:"bg-green-600",children:"Stripe kunde"}):t.jsx(g.C,{className:"bg-gray-600",children:"Ingen Stripe kunde"})]}),t.jsx(n.SZ,{children:e.email})]}),(0,t.jsxs)(n.aY,{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[t.jsx("div",{children:e.stripe_customer_id?(0,t.jsxs)("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-400",children:"Stripe kunde ID:"})," ",t.jsx("code",{className:"bg-gray-800 px-1 py-0.5 rounded text-xs",children:e.stripe_customer_id})]}):t.jsx("div",{className:"text-sm text-gray-400",children:"Ingen Stripe kunde tilknyttet"})}),t.jsx(i.z,{onClick:()=>M(e.id,e.email,e.full_name),disabled:!!S||!!e.stripe_customer_id,className:"gap-2",children:S===e.id?(0,t.jsxs)(t.Fragment,{children:[t.jsx(p.Z,{className:"h-4 w-4 animate-spin"}),"Oppretter..."]}):e.stripe_customer_id?"Allerede opprettet":(0,t.jsxs)(t.Fragment,{children:[t.jsx(h,{className:"h-4 w-4"}),"Opprett Stripe kunde"]})})]}),!e.stripe_customer_id&&(0,t.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-800",children:[t.jsx(d._,{htmlFor:`manual-customer-${e.id}`,className:"text-sm text-gray-400 mb-2 block",children:"Eller tilknytt eksisterende Stripe kunde ID:"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[t.jsx(l.I,{id:`manual-customer-${e.id}`,placeholder:"cus_...",value:e.id===Z?C:"",onChange:e=>P(e.target.value)}),t.jsx(i.z,{onClick:()=>F(e.id),disabled:!!Z||!C,variant:"outline",className:"gap-2",children:Z===e.id?t.jsx(p.Z,{className:"h-4 w-4 animate-spin"}):(0,t.jsxs)(t.Fragment,{children:[t.jsx(f,{className:"h-4 w-4"}),"Tilknytt"]})})]})]})]})]},e.id))})]})}},69436:(e,r,s)=>{"use strict";s.d(r,{C:()=>l});var t=s(95344);s(3729);var a=s(49247),i=s(91626);let n=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l({className:e,variant:r,...s}){return t.jsx("div",{className:(0,i.cn)(n({variant:r}),e),...s})}},61351:(e,r,s)=>{"use strict";s.d(r,{Ol:()=>l,SZ:()=>c,Zb:()=>n,aY:()=>o,eW:()=>u,ll:()=>d});var t=s(95344),a=s(3729),i=s(91626);let n=a.forwardRef(({className:e,...r},s)=>t.jsx("div",{ref:s,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...r}));n.displayName="Card";let l=a.forwardRef(({className:e,...r},s)=>t.jsx("div",{ref:s,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...r}));l.displayName="CardHeader";let d=a.forwardRef(({className:e,...r},s)=>t.jsx("div",{ref:s,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...r}));d.displayName="CardTitle";let c=a.forwardRef(({className:e,...r},s)=>t.jsx("div",{ref:s,className:(0,i.cn)("text-sm text-muted-foreground",e),...r}));c.displayName="CardDescription";let o=a.forwardRef(({className:e,...r},s)=>t.jsx("div",{ref:s,className:(0,i.cn)("p-6 pt-0",e),...r}));o.displayName="CardContent";let u=a.forwardRef(({className:e,...r},s)=>t.jsx("div",{ref:s,className:(0,i.cn)("flex items-center p-6 pt-0",e),...r}));u.displayName="CardFooter"},54572:(e,r,s)=>{"use strict";s.d(r,{_:()=>u});var t=s(95344),a=s(3729),i=s(65651),n=s(62409);let l=(0,a.forwardRef)((e,r)=>(0,a.createElement)(n.WV.label,(0,i.Z)({},e,{ref:r,onMouseDown:r=>{var s;null===(s=e.onMouseDown)||void 0===s||s.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault()}})));var d=s(49247),c=s(91626);let o=(0,d.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),u=a.forwardRef(({className:e,...r},s)=>t.jsx(l,{ref:s,className:(0,c.cn)(o(),e),...r}));u.displayName=l.displayName},67951:(e,r,s)=>{"use strict";s.d(r,{O:()=>i});var t=s(95344),a=s(91626);function i({className:e,...r}){return t.jsx("div",{className:(0,a.cn)("animate-pulse rounded-md bg-muted",e),...r})}},33733:(e,r,s)=>{"use strict";s.d(r,{Z:()=>t});let t=(0,s(69224).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},28765:(e,r,s)=>{"use strict";s.d(r,{Z:()=>t});let t=(0,s(69224).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},44596:(e,r,s)=>{"use strict";function t(){return null}s.r(r),s.d(r,{default:()=>t})},51985:(e,r,s)=>{"use strict";s.r(r),s.d(r,{$$typeof:()=>i,__esModule:()=>a,default:()=>n});let t=(0,s(86843).createProxy)(String.raw`/Users/alexanderamundsen/hepta/hepta-3/app/admin/users/page.tsx`),{__esModule:a,$$typeof:i}=t,n=t.default}};var r=require("../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[1638,4813,3113],()=>s(55773));module.exports=t})();